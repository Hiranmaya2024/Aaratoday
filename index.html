<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aaradhya Today</title>

<style>
/* SAME PREMIUM UI ‚Äî unchanged */
:root{
--primary:#0d6efd;
--bg:#eef2f7;
--card:#ffffff;
--text:#1f2933;
--success:#198754;
--danger:#dc3545;
--warning:#ff9800;
--radius:18px;
}

body{margin:0;font-family:system-ui;background:var(--bg);}
.app{max-width:1400px;margin:auto;}

.header{
position:sticky;top:0;
background:linear-gradient(135deg,#0d6efd,#3b82f6);
color:#fff;padding:16px;font-size:20px;font-weight:600;
}

.statusBar{
margin:14px;padding:12px 16px;border-radius:18px;
background:rgba(255,255,255,0.7);
display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px;
}

.routeGrid{display:grid;gap:16px;margin:14px;}
@media(min-width:768px){.routeGrid{grid-template-columns:1fr 1fr;}}

.partyList{max-height:280px;overflow:auto;}

.grid{
display:grid;grid-template-columns:repeat(2,1fr);
gap:14px;padding:14px;
}
@media(min-width:700px){.grid{grid-template-columns:repeat(3,1fr);}}
@media(min-width:1200px){.grid{grid-template-columns:repeat(4,1fr);}}

.card{background:var(--card);padding:16px;border-radius:18px;}

.blocked{border-left:6px solid var(--danger);}
.active{border-left:6px solid var(--success);}

.badge{padding:4px 10px;border-radius:999px;font-size:11px;color:#fff;margin-left:6px;}
.badgeBlocked{background:var(--danger);}
.badgeActive{background:var(--success);}
.badgeFollow{background:var(--warning);}
.newTag{background:#7c3aed;}

.iconBtn{
height:54px;border:none;border-radius:14px;
background:linear-gradient(135deg,#0d6efd,#3b82f6);
color:#fff;font-size:22px;display:flex;align-items:center;justify-content:center;
}

.profile{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--bg);overflow:auto;padding:20px;}
.profileCard{background:#fff;border-radius:18px;padding:20px;max-width:720px;margin:auto;}
.actionRow{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:18px;}
</style>
</head>

<body>

<div class="app">

<div class="header">Aaradhya Today</div>

<div class="statusBar">
<div id="dataInfo"></div>

<div>
Day :
<select id="daySelect" onchange="changeDay(this.value)">
<option>Monday</option>
<option>Tuesday</option>
<option>Wednesday</option>
<option>Thursday</option>
<option>Friday</option>
<option>Saturday</option>
</select>

<button onclick="fetchData()">üîÑ</button>
</div>
</div>

<div id="routeBox"></div>
<div id="grid" class="grid"></div>
<div id="profile" class="profile" style="display:none"></div>

</div>

<script>

const CSV="YOUR_CSV_LINK"

const HQ={lat:20.9964,lng:83.0526}

const tourPlan={
Monday:["Juria"],
Tuesday:["Ghess"],
Wednesday:["Gaisilate"],
Thursday:["Dava"],
Friday:["Padampur"],
Saturday:["Paikmal","Mandosil"]
}

let customers=[],visited=[],collections=[]
let selectedDay=new Date().toLocaleDateString('en-US',{weekday:'long'})

function changeDay(day){selectedDay=day;render()}

function getDistance(a,b){
const R=6371
const dLat=(b.lat-a.lat)*Math.PI/180
const dLng=(b.lng-a.lng)*Math.PI/180
const aa=Math.sin(dLat/2)**2+
Math.cos(a.lat*Math.PI/180)*Math.cos(b.lat*Math.PI/180)*
Math.sin(dLng/2)**2
return R*2*Math.atan2(Math.sqrt(aa),Math.sqrt(1-aa))
}

function getTodayRoute(){
let areas=tourPlan[selectedDay]||[]
return customers.filter(c=>areas.includes(c.area))
}

/* üî¢ NEAREST ROUTE SEQUENCE */

function getOptimizedRoute(route){

let remaining=[...route]
let ordered=[]
let current=HQ

while(remaining.length){

remaining.sort((a,b)=>
getDistance(current,a)-getDistance(current,b)
)

let next=remaining.shift()
ordered.push(next)
current=next
}

return ordered
}

function calcDistance(route){

let total=0
let current=HQ

route.forEach(p=>{
total+=getDistance(current,p)
current=p
})

total+=getDistance(current,HQ)

return total
}

function render(){

let todayRoute=getOptimizedRoute(getTodayRoute())

let routeDistance=calcDistance(todayRoute)

routeBox.innerHTML=`

<div class="routeGrid">

<div>

‚úî Parties: ${todayRoute.length}<br>
üìè ${routeDistance.toFixed(1)} km<br>
‚è± ${(routeDistance/25).toFixed(1)} hr<br>

<button class="iconBtn" onclick="startTour()">üß≠</button>

</div>

<div class="partyList">

${todayRoute.map((c,i)=>`

<div onclick="openProfile('${c.name}')">

<b>${i+1}Ô∏è‚É£ ${c.name}</b><br>

üìç ${getDistance(HQ,c).toFixed(1)} km

</div><br>

`).join("")}

</div>

</div>
`

}

function startTour(){

let route=getOptimizedRoute(getTodayRoute())

let waypoints=route.slice(0,9).map(p=>`${p.lat},${p.lng}`).join("/")

window.open(`https://www.google.com/maps/dir/${HQ.lat},${HQ.lng}/${waypoints}/${HQ.lat},${HQ.lng}`)
}

</script>
</body>
</html>